name: ğŸš€ Umitmod IPTV GÃ¼ncelleyici
on:
  schedule:
    - cron: "0 */3 * * *"  # Her 3 saatte bir (CRON syntax)
  workflow_dispatch:       # Manuel tetikleme

jobs:
  build-and-update:
    runs-on: ubuntu-latest
    permissions:
      contents: write  # Push iÅŸlemi iÃ§in izin

    steps:
      - name: ğŸ› ï¸ Repoyu Klonla
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # TÃ¼m commit geÃ§miÅŸi

      - name: ğŸ Python Kurulumu
        uses: actions/setup-python@v5
        with:
          python-version: "3.10"  # Sabit versiyon Ã¶nerilir

      - name: ğŸ“¦ BaÄŸÄ±mlÄ±lÄ±klarÄ± Kur
        run: |
          pip install httpx==0.27.0  # Versiyon sabitleme
          pip install requests  # Opsiyonel

      - name: ğŸƒâ€â™‚ï¸ Scripti Ã‡alÄ±ÅŸtÄ±r
        run: |
          python ugur.py || exit 1
        env:
          DISABLE_SSL_VERIFY: "True"  # SSL hatasÄ± iÃ§in

      - name: ğŸ” Ã‡Ä±ktÄ±yÄ± Kontrol Et
        run: |
          if [ ! -f "Umitmod.m3u" ]; then
            echo "âŒ Hata: M3U dosyasÄ± oluÅŸmadÄ±!"
            exit 1
          fi
          echo "âœ”ï¸ Dosya baÅŸarÄ±yla oluÅŸturuldu."

      - name: ğŸ“Œ DeÄŸiÅŸiklikleri GitHub'a GÃ¶nder
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git add Umitmod.m3u
          git commit -m "ğŸ”§ Otomatik gÃ¼ncelleme: $(date '+%d.%m.%Y %H:%M')" || echo "ğŸ”„ DeÄŸiÅŸiklik yok."
          git push
